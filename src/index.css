
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Cache bust: 2024-12-19 - Force column width changes */
 
@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
 
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
 
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
 
    --primary: 220 14% 96%;
    --primary-foreground: 220 14% 5%;
 
    --secondary: 220 14% 90%;
    --secondary-foreground: 220 14% 5%;
 
    --muted: 220 14% 96%;
    --muted-foreground: 220 14% 40%;
 
    --accent: 220 14% 96%;
    --accent-foreground: 220 14% 5%;
 
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
 
    --border: 220 14% 90%;
    --input: 220 14% 90%;
    --ring: 220 14% 80%;
 
    --radius: 0.5rem;
  }
}
 
@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
  
  /* Mobile viewport fixes */
  html {
    /* Use dynamic viewport height for better mobile support */
    height: 100dvh;
  }
  
  body {
    /* Ensure body can scroll properly on mobile */
    min-height: 100dvh;
    overflow-x: hidden;
  }
  
  /* Additional mobile scrolling fixes */
  @media (max-width: 1023px) {
    /* Ensure modals can scroll properly on mobile */
    .dialog-content {
      max-height: 100dvh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    
    /* Make sure the scrollable area takes available space */
    .mobile-form-container {
      flex: 1;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      /* Ensure we can scroll to the very bottom */
      padding-bottom: 10rem;
    }
    
    /* Force ActionButtons to be visible */
    .mobile-action-buttons {
      position: fixed !important;
      bottom: 0 !important;
      left: 0 !important;
      right: 0 !important;
      background: white !important;
      border-top: 2px solid #e2e8f0 !important;
      padding: 1rem !important;
      z-index: 1000 !important;
      box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.15) !important;
    }
  }
}

.fade-in {
  animation: fadeIn 0.3s ease-in;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.table-animation {
  animation: tableRow 0.4s ease-out;
}

@keyframes tableRow {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Update the flash-upd animation for better visibility */
.flash-upd {
  animation: flashUpd 1s infinite !important;
  font-weight: bold !important;
  border: 4px solid #dc2626 !important;
  box-shadow: 0 0 10px rgba(220, 38, 38, 0.5) !important;
  border-radius: 4px !important;
  padding: 2px 4px !important;
}

@keyframes flashUpd {
  0%, 40% {
    background-color: #fef2f2 !important;
    color: #dc2626 !important;
    border-color: #dc2626 !important;
    box-shadow: 0 0 10px rgba(220, 38, 38, 0.5) !important;
  }
  50%, 90% {
    background-color: #dc2626 !important;
    color: white !important;
    border-color: #991b1b !important;
    box-shadow: 0 0 15px rgba(220, 38, 38, 0.8) !important;
  }
  100% {
    background-color: #fef2f2 !important;
    color: #dc2626 !important;
    border-color: #dc2626 !important;
    box-shadow: 0 0 10px rgba(220, 38, 38, 0.5) !important;
  }
}

/* Eliminate gaps between table cells */
.defect-records-table {
  border-collapse: collapse !important;
  border-spacing: 0 !important;
  table-layout: fixed !important;
  width: 100% !important;
}

.defect-records-table td,
.defect-records-table th {
  padding: 0 !important;
  margin: 0 !important;
  border-spacing: 0 !important;
  border-collapse: collapse !important;
  box-sizing: border-box !important;
}

/* Force checkbox columns to be as narrow as possible */
.defect-records-table .checkbox-column {
  width: 0.3% !important;
  min-width: 20px !important;
  max-width: 20px !important;
  overflow: hidden !important;
}


/* Specific styling for checkbox columns to minimize gaps */
.checkbox-column {
  width: 0.3% !important;
  min-width: 20px !important;
  max-width: 20px !important;
  padding: 0 !important;
  margin: 0 !important;
  border: none !important;
  text-align: center !important;
  white-space: nowrap !important;
}

.checkbox-column > div {
  padding: 4px 0px !important;
  margin: 0 !important;
  width: 100% !important;
  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
}

/* Make checkboxes smaller in narrow columns */
.checkbox-column .h-6 {
  height: 16px !important;
  width: 16px !important;
}

/* Reduce gaps for time, registration, and station columns */
.defect-records-table td:nth-child(1),
.defect-records-table td:nth-child(2),
.defect-records-table td:nth-child(3) {
  padding-left: 5px !important;
  padding-right: 5px !important;
}

.defect-records-table th:nth-child(1),
.defect-records-table th:nth-child(2),
.defect-records-table th:nth-child(3) {
  padding-left: 5px !important;
  padding-right: 5px !important;
}

/* Set specific widths for defect and remarks columns */
.defect-records-table td:nth-child(4),
.defect-records-table th:nth-child(4) {
  width: 20% !important;
}

.defect-records-table td:nth-child(5),
.defect-records-table th:nth-child(5) {
  width: 20% !important;
}

/* Mobile responsive styles */
@media (max-width: 640px) {
  .table-cell-mobile {
    @apply text-xs p-1;
  }
  
  .defect-cell-mobile {
    max-width: 100px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
}

/* Improve drawer appearance on mobile */
.drawer-content {
  @apply rounded-t-xl;
  max-height: 80vh;
}

/* Mobile and tablet-specific improvements */
@media (max-width: 1023px) {
  /* Improve touch targets */
  button, input, select, textarea {
    min-height: 44px;
  }
  
  /* Better spacing for mobile forms */
  .space-y-3 > * + * {
    margin-top: 0.75rem;
  }
  
  /* Improve modal appearance on mobile */
  [role="dialog"] {
    margin: 1rem;
    max-height: calc(100vh - 2rem);
    /* Ensure modal can scroll when keyboard is visible */
    overflow-y: auto;
    /* Use dynamic viewport height for better mobile support */
    max-height: calc(100dvh - 2rem);
    /* Ensure proper positioning when keyboard is visible */
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }
  
  /* Mobile-specific dialog improvements */
  @media (max-width: 1023px) {
    [role="dialog"] {
      /* Better mobile positioning */
      margin: 0.25rem;
      max-height: calc(100dvh - 0.5rem);
      width: calc(100vw - 0.5rem);
      /* Ensure it stays in view when keyboard appears */
      position: fixed;
      top: 0.25rem;
      left: 0.25rem;
      right: 0.25rem;
      bottom: 0.25rem;
      transform: none;
      /* Ensure proper overflow handling */
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    
    /* Ensure dialog content can scroll properly */
    [role="dialog"] .dialog-content {
      flex: 1;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
  }
  
  /* Fix scrolling issues when keyboard is visible */
  .mobile-modal-content {
    max-height: calc(100dvh - 4rem);
    overflow-y: auto;
    padding-bottom: 2rem;
  }
  
  /* Ensure form content is scrollable on mobile */
  .mobile-form-container {
    max-height: calc(100dvh - 4rem);
    overflow-y: auto;
    /* Ensure smooth scrolling */
    -webkit-overflow-scrolling: touch;
    /* Add extra padding at bottom for better scrolling */
    padding-bottom: 8rem;
    /* Ensure content can scroll to the very bottom */
    min-height: calc(100dvh - 4rem);
  }
  
  /* Mobile modal dialog improvements */
  .mobile-modal-dialog {
    max-height: 100dvh;
    overflow: hidden;
  }
  
  .mobile-modal-dialog .dialog-content {
    max-height: 100dvh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }
  
  .mobile-modal-dialog .dialog-body {
    flex: 1;
    overflow-y: auto;
    padding-bottom: 1rem;
  }
  
  .mobile-modal-dialog .dialog-actions {
    flex-shrink: 0;
    padding-top: 1rem;
    border-top: 1px solid #e2e8f0;
    background: white;
  }
  
  /* Ensure ActionButtons are fully visible on mobile */
  .mobile-action-buttons {
    margin-top: 3rem;
    padding: 2rem 1rem 2rem 1rem;
    border-top: 2px solid #e2e8f0;
    background: white;
    /* Ensure buttons are always visible */
    position: sticky;
    bottom: 0;
    z-index: 20;
    /* Add shadow for better visibility */
    box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.1);
  }
  
  /* Better mobile table handling */
  .defect-records-table {
    font-size: 0.875rem;
  }
  
  /* Mobile-friendly form layouts */
  .grid-cols-1 > * {
    width: 100%;
  }
  
  /* Improve mobile button spacing */
  .space-x-3 > * + * {
    margin-left: 0.75rem;
  }
  
  .space-y-3 > * + * {
    margin-top: 0.75rem;
  }
  
  /* Mobile and tablet table improvements */
  .line-clamp-1 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
  }
  
  .line-clamp-2 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
  }
  
  /* Mobile record cards */
  .mobile-record-card {
    transition: all 0.2s ease-in-out;
  }
  
  .mobile-record-card:active {
    transform: scale(0.98);
  }
  
  /* Colored row backgrounds for SL and OK only - matching desktop */
  .mobile-record-card.bg-yellow-200 {
    background-color: #fde68a;
  }
  
  .mobile-record-card.bg-green-200 {
    background-color: #bbf7d0;
  }
}

/* Print styles for better readability */
@media print {
  * {
    -webkit-print-color-adjust: exact !important;
    color-adjust: exact !important;
  }
  
  body {
    font-size: 14px !important;
    line-height: 1.4 !important;
    color: #000 !important;
    background: white !important;
  }
  
  /* Ensure tables are readable when printed */
  table {
    font-size: 12px !important;
    border-collapse: collapse !important;
  }
  
  th, td {
    font-size: 11px !important;
    padding: 4px 6px !important;
    border: 1px solid #000 !important;
  }
  
  th {
    background-color: #f0f0f0 !important;
    font-weight: bold !important;
  }
  
  /* Hide non-essential elements when printing */
  .no-print,
  button:not(.print-button),
  .print-hide {
    display: none !important;
  }
  
  /* Ensure proper page breaks */
  .page-break-before {
    page-break-before: always !important;
  }
  
  .page-break-after {
    page-break-after: always !important;
  }
  
  .page-break-inside-avoid {
    page-break-inside: avoid !important;
  }
  
  /* Improve header visibility */
  h1, h2, h3, h4, h5, h6 {
    color: #000 !important;
    font-weight: bold !important;
  }
  
  h1 { font-size: 20px !important; }
  h2 { font-size: 18px !important; }
  h3 { font-size: 16px !important; }
  h4 { font-size: 14px !important; }
  h5 { font-size: 13px !important; }
  h6 { font-size: 12px !important; }
  
  /* Improve checkbox visibility when printing */
  input[type="checkbox"] {
    width: 12px !important;
    height: 12px !important;
    border: none !important;
    background-color: white !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    position: relative !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  input[type="checkbox"]:checked {
    background-color: white !important;
  }
  
  /* Primary checkmark with enhanced visibility */
  input[type="checkbox"]:checked::after {
    content: "✓" !important;
    position: absolute !important;
    top: -2px !important;
    left: 1px !important;
    color: black !important;
    font-size: 10px !important;
    font-weight: bold !important;
    line-height: 1 !important;
    text-shadow: none !important;
  }
  
  /* Backup checkmark for better browser compatibility */
  input[type="checkbox"]:checked::before {
    content: "✓" !important;
    position: absolute !important;
    top: -2px !important;
    left: 1px !important;
    color: black !important;
    font-size: 10px !important;
    font-weight: bold !important;
    line-height: 1 !important;
    z-index: 1 !important;
    text-shadow: none !important;
  }
  
  /* Alternative approach using SVG checkmark for better visibility */
  input[type="checkbox"]:checked {
    background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='black' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e") !important;
    background-size: 8px 8px !important;
    background-position: center !important;
    background-repeat: no-repeat !important;
  }
}
